{% extends 'base.html' %}

{% block title %} - Claims{% endblock %}

{% block extrahead %}
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.1/jquery-ui.js"></script>
    <script>
        $(function() {
            $( "#dateFromSearchBox" ).datepicker(
                {changeMonth: true,
                 changeYear: true,
                 yearRange: "1900:2015"});
            $( "#dateToSearchBox" ).datepicker(
                {changeMonth: true,
                 changeYear: true,
                 yearRange: "1900:2015"});
        });
    </script>
{% endblock %}

{% include 'navbar.html' %}

{% block content %}

{% include 'clients/snippets/messages.html' %}
<h1>Claims</h1>
<form method="GET" class="form-inline">
    <div class="form-group">
        <input type="text" id="searchBox" class="form-control search-query" name="q" placeholder="Claim Search" value="{{ q }}">
    </div>
    <div class="form-group">
        <input type="text" id="dateFromSearchBox" class="form-control search-query" name="df" placeholder="Date From" value="{{ df }}">
    </div>
    <div class="form-group">
        <input type="text" id="dateToSearchBox" class="form-control search-query" name="dt" placeholder="Date To" value="{{ dt }}">
    </div>
    <div class="radio">
        <label>
            <input type="radio" name="apd" value="has_actual_paid_date" {% if apd == 'has_actual_paid_date' %}checked{% endif %}>
            Has Actual Paid Date
        </label>
        <br />
        <label>
            <input type="radio" name="apd" value="no_actual_paid_date" {% if apd == 'no_actual_paid_date' %}checked{% endif %}>
            No Actual Paid Date
        </label>
        <br />
        <label>
            <input type="radio" name="apd" value="both_actual_paid_date" {% if apd == 'both_actual_paid_date' %}checked{% endif %}>
            Both
        </label>
    </div>
    <button type="submit" class="btn">Search</button>
</form>
{% if claims %}
    {% include 'clients/snippets/claims.html' %}
{% elif q or df or dt %}
    <p>There are no claims for this search.</p>
{% else %}
    <p>There are no claims currenty.</p>
{% endif %}

<!-- Pagination stuff -->
<div class="pagination">
    <span class="step-links">
        {% if claims.has_previous %}
            <a href="?q={{q}}&df={{df}}&dt={{dt}}&apd={{apd}}&page={{ claims.previous_page_number }}" class="btn btn-default">Previous</a>
        {% endif %}

        {% if claims.number %}
            <span class="current">
                Page {{ claims.number }} of {{ claims.paginator.num_pages }}.
            </span>
        {% endif %}

        {% if claims.has_next %}
            <a href="?q={{q}}&df={{df}}&dt={{dt}}&apd={{apd}}&page={{ claims.next_page_number }}" class="btn btn-default">Next</a>
        {% endif %}
    </span>
</div>
<form method="GET" style="display: inline-block;">
    {% if q %}
        <input type="hidden" name="q" value="{{ q }}">
    {% endif %}
    {% if df %}
        <input type="hidden" name="df" value="{{ df }}">
    {% endif %}
    {% if dt %}
        <input type="hidden" name="dt" value="{{ dt }}">
    {% endif %}
    {% if apd %}
        <input type="hidden" name="apd" value="{{ apd }}">
    {% endif %}
    Rows per Page: <input type="number" id="claims_rows_per_page" name="claims_rows_per_page" value="{{ claims_rows_per_page }}">
    <input type="submit" class="btn" value="Paginate">
</form>
<div>
    A = Assignment,
    NA = Non-assignment,
    EB = Expected Back,
    AC = Amount Claimed
</div>
<div class="table-responsive">
    <table class="table table-striped table-cover">
        <thead>
            <tr>
                <th>NA EB</th>
                <th>A EB</th>
                <th>Pending A EB</th>
                <th>Total A EB</th>
                <th>Total EB</th>
                <th>NA AC</th>
                <th>A AC</th>
                <th>Total AC</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ non_assignment_expected_back }}</td>
                <td>{{ assignment_expected_back }}</td>
                <td>{{ pending_assignment_expected_back }}</td>
                <td>{{ total_assignment_expected_back }}</td>
                <td>{{ total_expected_back }}</td>
                <td>{{ non_assignment_amount_claimed }}</td>
                <td>{{ assignment_amount_claimed }}</td>
                <td>{{ total_amount_claimed }}</td>
            </tr>
        </tbody>
    </table>
</div>

{% endblock %}
